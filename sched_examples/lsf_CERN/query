#!/usr/local/bin/perl5 -w

# return couples sid state for all jobs idle and running

#$command = "bjobs -u all -w |";
$command = "bjobs |";
open (CONQ , $command );

# skip first line
$_ = <CONQ>;

while ($_ = <CONQ>) {

    @st = split (/ +/,$_);
    $user=$st[1];
while (defined($workdir= </pool/lsf/$user/$st[0]_*>)) {
    $_=$workdir;
    /_/;
    $initbid=$';}
	    if ( $st[2] eq "RUN" ) {
                if (defined $initbid) {
		    print "$initbid R\n";}
		else {print "$st[0] R\n";}
	    } else {
		print "$st[0] I\n";
	    }
	}



close(CONQ);
